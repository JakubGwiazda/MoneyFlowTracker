<div class="expenses-page-container">
  <header class="page-header space-y-1">
    <h1 class="text-2xl font-semibold text-gray-900">Lista wydatków</h1>
    <p class="text-sm text-gray-600">
      Zarządzaj wydatkami, filtruj według daty i statusu klasyfikacji, a także dodawaj nowe pozycje.
    </p>
  </header>

  <mat-tab-group class="tab_group">
    <mat-tab label="Wizualizacja wydatków">
      <div class="tab-content mt-2">
        <app-expenses-charts
          [data]="chartData()"
          [title]="'Wydatki według kategorii'"
          [xAxisLabel]="'Kategorie'"
          [yAxisLabel]="'Kwota (PLN)'"
          [showLegend]="true"
          [gradient]="false"
          [animations]="true"
          [dateFilterValue]="{
            preset: vm().filters.preset ?? 'today',
            date_from: vm().filters.date_from,
            date_to: vm().filters.date_to
          }"
          (dateFilterChange)="onChartDateFilterChange($event)"
        />
      </div>
    </mat-tab>
    <mat-tab label="Lista wydatków">        
      <div class="tab-content mt-2">
        <mat-card class="filters-card">
          <mat-expansion-panel class="filters-expansion-panel" [expanded]="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Filtry wyszukiwania
              </mat-panel-title>
              <mat-panel-description>
                Kliknij aby rozwinąć/zwinąć filtry
              </mat-panel-description>
            </mat-expansion-panel-header>
            
            <app-expenses-filters
              [value]="vm().filters"
              [loading]="vm().loading"
              [categories]="categoryOptions()"
              (filterChange)="onFilterChange($event)"
              (addExpenseClick)="onAddExpense()"
              (categorySearch)="onCategorySearch($event)"
            />
          </mat-expansion-panel>
        </mat-card>

        <div class="table-container">
          <app-expenses-table
            [data]="vm().expenses"
            [loading]="vm().loading"
            [sortState]="vm().sort"
            (sortChange)="onSortChange($event)"
            (editExpense)="onEditExpense($event)"
            (reclassifyExpense)="onReclassifyExpense($event)"
            (deleteExpense)="onDeleteExpense($event)"
          />
        </div>
        
        <div class="pagination-container">
          <app-pagination-controls
            [state]="vm().pagination"
            [disabled]="vm().loading"
            (pageChange)="onPageChange($event)"
            (perPageChange)="onPerPageChange($event)"
          />
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Kategorie">
      <div class="tab-content">
        <app-categories-page />
      </div>
    </mat-tab>
  </mat-tab-group>
</div>